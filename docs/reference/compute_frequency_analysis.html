<!-- Generated by pkgdown: do not edit by hand -->
<!DOCTYPE html>
<html lang="en">
  <head>
  <meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">

<title>Perform a custom annual frequency analysis — compute_frequency_analysis • fasstr</title>


<!-- jquery -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.4.1/jquery.min.js" integrity="sha256-CSXorXvZcTkaix6Yvo6HppcZGetbYMGWSFlBw8HfCJo=" crossorigin="anonymous"></script>
<!-- Bootstrap -->
<link href="https://cdnjs.cloudflare.com/ajax/libs/bootswatch/3.4.0/flatly/bootstrap.min.css" rel="stylesheet" crossorigin="anonymous" />


<script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script>

<!-- bootstrap-toc -->
<link rel="stylesheet" href="../bootstrap-toc.css">
<script src="../bootstrap-toc.js"></script>

<!-- Font Awesome icons -->
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous" />
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous" />

<!-- clipboard.js -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script>

<!-- headroom.js -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script>

<!-- pkgdown -->
<link href="../pkgdown.css" rel="stylesheet">
<script src="../pkgdown.js"></script>




<meta property="og:title" content="Perform a custom annual frequency analysis — compute_frequency_analysis" />
<meta property="og:description" content="Performs a flow volume frequency analysis from a streamflow dataset. Defaults to ranking by minimums; 
   use use_max for to rank by maximum flows. Calculates the statistics from events
   and flow values provided. Columns of events (years), their values (mins or maxs), and identifiers (lowflows, highflows, etc),
   Function will calculate using all values in the provided data (no grouped analysis). Analysis methodology replicates that 
   from HEC-SSP." />




<!-- mathjax -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script>

<!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->



  </head>

  <body data-spy="scroll" data-target="#toc">
    <div class="container template-reference-topic">
      <header>
      <div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">fasstr</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="Released version">0.3.2</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
        <li>
  <a href="../index.html">
    <span class="fa fa-home"></span>
     
  </a>
</li>
<li>
  <a href="../articles/fasstr.html">Get Started</a>
</li>
<li>
  <a href="../reference/index.html">Functions</a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-expanded="false">
    Articles
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
    <li>
      <a href="../articles/fasstr_users_guide.html">Users Guide</a>
    </li>
    <li>
      <a href="../articles/fasstr_trending_analysis.html">Computing Annual Trends</a>
    </li>
    <li>
      <a href="../articles/fasstr_frequency_analysis.html">Computing Volume Frequency Analyses</a>
    </li>
    <li>
      <a href="../articles/fasstr_full_analysis.html">Computing a Full Analysis</a>
    </li>
    <li>
      <a href="../articles/fasstr_under_the_hood.html">Under the Hood</a>
    </li>
  </ul>
</li>
<li>
  <a href="../news/index.html">News</a>
</li>
      </ul>
      <ul class="nav navbar-nav navbar-right">
        <li>
  <a href="https://github.com/bcgov/fasstr/raw/master/fasstr_cheatsheet.pdf">
    <span class="fa fa-file-download"></span>
     
    Download Cheatsheet
  </a>
</li>
<li>
  <a href="https://github.com/bcgov/fasstr">
    <span class="fa fa-github fa-lg"></span>
     
    GitHub
  </a>
</li>
      </ul>
      
    </div><!--/.nav-collapse -->
  </div><!--/.container -->
</div><!--/.navbar -->

      

      </header>

<div class="row">
  <div class="col-md-9 contents">
    <div class="page-header">
    <h1>Perform a custom annual frequency analysis</h1>
    <small class="dont-index">Source: <a href='https://github.com/bcgov/fasstr/blob/master/R/compute_frequency_analysis.R'><code>R/compute_frequency_analysis.R</code></a></small>
    <div class="hidden name"><code>compute_frequency_analysis.Rd</code></div>
    </div>

    <div class="ref-description">
    <p>Performs a flow volume frequency analysis from a streamflow dataset. Defaults to ranking by minimums; 
   use <code>use_max</code> for to rank by maximum flows. Calculates the statistics from events
   and flow values provided. Columns of events (years), their values (mins or maxs), and identifiers (lowflows, highflows, etc),
   Function will calculate using all values in the provided data (no grouped analysis). Analysis methodology replicates that 
   from <a href='http://www.hec.usace.army.mil/software/hec-ssp/'>HEC-SSP</a>.</p>
    </div>

    <pre class="usage"><span class='fu'>compute_frequency_analysis</span>(
  <span class='no'>data</span>,
  <span class='kw'>events</span> <span class='kw'>=</span> <span class='no'>Year</span>,
  <span class='kw'>values</span> <span class='kw'>=</span> <span class='no'>Value</span>,
  <span class='kw'>measures</span> <span class='kw'>=</span> <span class='no'>Measure</span>,
  <span class='kw'>use_max</span> <span class='kw'>=</span> <span class='fl'>FALSE</span>,
  <span class='kw'>use_log</span> <span class='kw'>=</span> <span class='fl'>FALSE</span>,
  <span class='kw'>prob_plot_position</span> <span class='kw'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span>(<span class='st'>"weibull"</span>, <span class='st'>"median"</span>, <span class='st'>"hazen"</span>),
  <span class='kw'>prob_scale_points</span> <span class='kw'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span>(<span class='fl'>0.9999</span>, <span class='fl'>0.999</span>, <span class='fl'>0.99</span>, <span class='fl'>0.9</span>, <span class='fl'>0.5</span>, <span class='fl'>0.2</span>, <span class='fl'>0.1</span>, <span class='fl'>0.02</span>, <span class='fl'>0.01</span>, <span class='fl'>0.001</span>,
    <span class='fl'>1e-04</span>),
  <span class='kw'>fit_distr</span> <span class='kw'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span>(<span class='st'>"PIII"</span>, <span class='st'>"weibull"</span>),
  <span class='kw'>fit_distr_method</span> <span class='kw'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/ifelse.html'>ifelse</a></span>(<span class='no'>fit_distr</span> <span class='kw'>==</span> <span class='st'>"PIII"</span>, <span class='st'>"MOM"</span>, <span class='st'>"MLE"</span>),
  <span class='kw'>fit_quantiles</span> <span class='kw'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span>(<span class='fl'>0.975</span>, <span class='fl'>0.99</span>, <span class='fl'>0.98</span>, <span class='fl'>0.95</span>, <span class='fl'>0.9</span>, <span class='fl'>0.8</span>, <span class='fl'>0.5</span>, <span class='fl'>0.2</span>, <span class='fl'>0.1</span>, <span class='fl'>0.05</span>, <span class='fl'>0.01</span>),
  <span class='kw'>plot_curve</span> <span class='kw'>=</span> <span class='fl'>TRUE</span>,
  <span class='kw'>remove_zeros</span> <span class='kw'>=</span> <span class='fl'>FALSE</span>
)</pre>

    <h2 class="hasAnchor" id="arguments"><a class="anchor" href="#arguments"></a>Arguments</h2>
    <table class="ref-arguments">
    <colgroup><col class="name" /><col class="desc" /></colgroup>
    <tr>
      <th>data</th>
      <td><p>A data frame of flow data that contains columns of events, flow values, and measures (data type).</p></td>
    </tr>
    <tr>
      <th>events</th>
      <td><p>Column in <code>data</code> that contains event identifiers, typically year values. Default <code>"Year"</code>.</p></td>
    </tr>
    <tr>
      <th>values</th>
      <td><p>Column in <code>data</code> that contains numeric flow values, in units of cubic metres per second. Default <code>"Value"</code>.</p></td>
    </tr>
    <tr>
      <th>measures</th>
      <td><p>Column in <code>data</code> that contains measure identifiers (example data: '7-day low' or 'Annual Max'). Can have multiple
measures (ex. '7-day low' and '30-day low') in column if multiple statistics are desired. Default <code>"Measure"</code>.</p></td>
    </tr>
    <tr>
      <th>use_max</th>
      <td><p>Logical value to indicate using annual maximums rather than the minimums for analysis. Default <code>FALSE</code>.</p></td>
    </tr>
    <tr>
      <th>use_log</th>
      <td><p>Logical value to indicate log-scale transforming of flow data before analysis. Default <code>FALSE</code>.</p></td>
    </tr>
    <tr>
      <th>prob_plot_position</th>
      <td><p>Character string indicating the plotting positions used in the frequency plots, one of "weibull",
"median", or "hazen". Points are plotted against  (i-a)/(n+1-a-b) where <code>i</code> is the rank of the value; <code>n</code> is the 
sample size and <code>a</code> and <code>b</code> are defined as: (a=0, b=0) for Weibull plotting positions; (a=.2; b=.3) for Median 
plotting positions; and (a=.5; b=.5) for Hazen plotting positions. Default <code>"weibull"</code>.</p></td>
    </tr>
    <tr>
      <th>prob_scale_points</th>
      <td><p>Numeric vector of probabilities to be plotted along the X axis in the frequency plot. Inverse of 
return period. Default <code><a href='https://rdrr.io/r/base/c.html'>c(.9999, .999, .99, .9, .5, .2, .1, .02, .01, .001, .0001)</a></code>.</p></td>
    </tr>
    <tr>
      <th>fit_distr</th>
      <td><p>Character string identifying the distribution to fit annual data, one of "PIII" (Pearson Log III distribution) 
or "weibull" (Weibull distribution). Default <code>"PIII"</code>.</p></td>
    </tr>
    <tr>
      <th>fit_distr_method</th>
      <td><p>Character string identifying the method used to fit the distribution, one of  "MOM" (method of moments) 
or "MLE" (maximum likelihood estimation). Selected as <code>"MOM"</code> if <code>fit_distr</code>=="PIII" (default) or <code>"MLE"</code> if 
 <code>fit_distr</code>=="weibull".</p></td>
    </tr>
    <tr>
      <th>fit_quantiles</th>
      <td><p>Numeric vector of quantiles to be estimated from the fitted distribution. 
Default <code><a href='https://rdrr.io/r/base/c.html'>c(.975, .99, .98, .95, .90, .80, .50, .20, .10, .05, .01)</a></code>.</p></td>
    </tr>
    <tr>
      <th>plot_curve</th>
      <td><p>Logical value to indicate plotting the computed curve on the probability plot. Default <code>TRUE</code>.</p></td>
    </tr>
    <tr>
      <th>remove_zeros</th>
      <td><p>Logical value to indicate removing any minimum values of zero from the dataset.</p></td>
    </tr>
    </table>

    <h2 class="hasAnchor" id="value"><a class="anchor" href="#value"></a>Value</h2>

    <p>A list with the following elements:</p>
<dt>Freq_Analysis_Data</dt><dd><p>Data frame with computed annual summary statistics used in analysis.</p></dd>
  <dt>Freq_Plot_Data</dt><dd><p>Data frame with co-ordinates used in frequency plot.</p></dd>
  <dt>Freq_Plot</dt><dd><p>ggplot2 object with frequency plot</p></dd>
  <dt>Freq_Fitting</dt><dd><p>List of fitted objects from fitdistrplus.</p></dd>
  <dt>Freq_Fitted_Quantiles</dt><dd><p>Data frame with fitted quantiles.</p></dd>


    <h2 class="hasAnchor" id="examples"><a class="anchor" href="#examples"></a>Examples</h2>
    <pre class="examples"><div class='input'><span class='kw'>if</span> (<span class='fl'>FALSE</span>) {

 <span class='co'># Working example:</span>

<span class='co'># Calculate some values to use for a frequency analysis </span>
<span class='co'># (requires years, values for those years, and the name of the measure/metric)</span>
<span class='no'>low_flows</span> <span class='kw'>&lt;-</span> <span class='fu'><a href='calc_annual_lowflows.html'>calc_annual_lowflows</a></span>(<span class='kw'>station_number</span> <span class='kw'>=</span> <span class='st'>"08NM116"</span>,
                                  <span class='kw'>start_year</span> <span class='kw'>=</span> <span class='fl'>1980</span>,
                                  <span class='kw'>end_year</span> <span class='kw'>=</span> <span class='fl'>2000</span>,
                                  <span class='kw'>roll_days</span> <span class='kw'>=</span> <span class='fl'>7</span>)
<span class='no'>low_flows</span> <span class='kw'>&lt;-</span> <span class='kw pkg'>dplyr</span><span class='kw ns'>::</span><span class='fu'><a href='https://dplyr.tidyverse.org/reference/select.html'>select</a></span>(<span class='no'>low_flows</span>, <span class='no'>Year</span>, <span class='kw'>Value</span> <span class='kw'>=</span> <span class='no'>Min_7_Day</span>)
<span class='no'>low_flows</span> <span class='kw'>&lt;-</span> <span class='kw pkg'>dplyr</span><span class='kw ns'>::</span><span class='fu'><a href='https://dplyr.tidyverse.org/reference/mutate.html'>mutate</a></span>(<span class='no'>low_flows</span>, <span class='kw'>Measure</span> <span class='kw'>=</span> <span class='st'>"7-Day"</span>)

<span class='co'># Compute the frequency analysis using the default parameters</span>
<span class='no'>results</span> <span class='kw'>&lt;-</span> <span class='fu'>compute_frequency_analysis</span>(<span class='kw'>data</span> <span class='kw'>=</span> <span class='no'>low_flows</span>,
                                      <span class='kw'>events</span> <span class='kw'>=</span> <span class='no'>Year</span>,
                                      <span class='kw'>values</span> <span class='kw'>=</span> <span class='no'>Value</span>,
                                      <span class='kw'>measure</span> <span class='kw'>=</span> <span class='no'>Measure</span>)

}</div></pre>
  </div>
  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">
    <nav id="toc" data-toggle="toc" class="sticky-top">
      <h2 data-toc-skip>Contents</h2>
    </nav>
  </div>
</div>


      <footer>
      <div class="copyright">
  <p>Developed by Jon Goetz, Carl James Schwarz.</p>
</div>

<div class="pkgdown">
  <p>Site built with <a href="https://pkgdown.r-lib.org/">pkgdown</a> 1.5.1.</p>
</div>

      </footer>
   </div>

  


  </body>
</html>


