<!-- Generated by pkgdown: do not edit by hand -->
<!DOCTYPE html>
<html lang="en">
  <head>
  <meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">

<title>Calculate annual days above and below normal — calc_annual_outside_normal • fasstr</title>


<!-- jquery -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.4.1/jquery.min.js" integrity="sha256-CSXorXvZcTkaix6Yvo6HppcZGetbYMGWSFlBw8HfCJo=" crossorigin="anonymous"></script>
<!-- Bootstrap -->
<link href="https://cdnjs.cloudflare.com/ajax/libs/bootswatch/3.4.0/flatly/bootstrap.min.css" rel="stylesheet" crossorigin="anonymous" />


<script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script>

<!-- bootstrap-toc -->
<link rel="stylesheet" href="../bootstrap-toc.css">
<script src="../bootstrap-toc.js"></script>

<!-- Font Awesome icons -->
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous" />
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous" />

<!-- clipboard.js -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script>

<!-- headroom.js -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script>

<!-- pkgdown -->
<link href="../pkgdown.css" rel="stylesheet">
<script src="../pkgdown.js"></script>




<meta property="og:title" content="Calculate annual days above and below normal — calc_annual_outside_normal" />
<meta property="og:description" content="Calculates the number of days per year outside of the 'normal' range (typically between 25 and 75th percentiles) for
   each day of the year. Upper and lower-range percentiles are calculated for each day of the year of from all years, and then each 
   daily flow value for each year is compared. All days above or below the normal range are included. Calculates the statistics 
   from all daily discharge values from all years, unless specified." />




<!-- mathjax -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script>

<!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->



  </head>

  <body data-spy="scroll" data-target="#toc">
    <div class="container template-reference-topic">
      <header>
      <div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">fasstr</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="Released version">0.3.2</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
        <li>
  <a href="../index.html">
    <span class="fa fa-home"></span>
     
  </a>
</li>
<li>
  <a href="../articles/fasstr.html">Get Started</a>
</li>
<li>
  <a href="../reference/index.html">Functions</a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-expanded="false">
    Articles
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
    <li>
      <a href="../articles/fasstr_users_guide.html">Users Guide</a>
    </li>
    <li>
      <a href="../articles/fasstr_trending_analysis.html">Computing Annual Trends</a>
    </li>
    <li>
      <a href="../articles/fasstr_frequency_analysis.html">Computing Volume Frequency Analyses</a>
    </li>
    <li>
      <a href="../articles/fasstr_full_analysis.html">Computing a Full Analysis</a>
    </li>
    <li>
      <a href="../articles/fasstr_under_the_hood.html">Under the Hood</a>
    </li>
  </ul>
</li>
<li>
  <a href="../news/index.html">News</a>
</li>
      </ul>
      <ul class="nav navbar-nav navbar-right">
        <li>
  <a href="https://github.com/bcgov/fasstr/raw/master/fasstr_cheatsheet.pdf">
    <span class="fa fa-file-download"></span>
     
    Download Cheatsheet
  </a>
</li>
<li>
  <a href="https://github.com/bcgov/fasstr">
    <span class="fa fa-github fa-lg"></span>
     
    GitHub
  </a>
</li>
      </ul>
      
    </div><!--/.nav-collapse -->
  </div><!--/.container -->
</div><!--/.navbar -->

      

      </header>

<div class="row">
  <div class="col-md-9 contents">
    <div class="page-header">
    <h1>Calculate annual days above and below normal</h1>
    <small class="dont-index">Source: <a href='https://github.com/bcgov/fasstr/blob/master/R/calc_annual_outside_normal.R'><code>R/calc_annual_outside_normal.R</code></a></small>
    <div class="hidden name"><code>calc_annual_outside_normal.Rd</code></div>
    </div>

    <div class="ref-description">
    <p>Calculates the number of days per year outside of the 'normal' range (typically between 25 and 75th percentiles) for
   each day of the year. Upper and lower-range percentiles are calculated for each day of the year of from all years, and then each 
   daily flow value for each year is compared. All days above or below the normal range are included. Calculates the statistics 
   from all daily discharge values from all years, unless specified.</p>
    </div>

    <pre class="usage"><span class='fu'>calc_annual_outside_normal</span>(
  <span class='no'>data</span>,
  <span class='kw'>dates</span> <span class='kw'>=</span> <span class='no'>Date</span>,
  <span class='kw'>values</span> <span class='kw'>=</span> <span class='no'>Value</span>,
  <span class='kw'>groups</span> <span class='kw'>=</span> <span class='no'>STATION_NUMBER</span>,
  <span class='no'>station_number</span>,
  <span class='kw'>normal_percentiles</span> <span class='kw'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span>(<span class='fl'>25</span>, <span class='fl'>75</span>),
  <span class='kw'>roll_days</span> <span class='kw'>=</span> <span class='fl'>1</span>,
  <span class='kw'>roll_align</span> <span class='kw'>=</span> <span class='st'>"right"</span>,
  <span class='kw'>water_year_start</span> <span class='kw'>=</span> <span class='fl'>1</span>,
  <span class='no'>start_year</span>,
  <span class='no'>end_year</span>,
  <span class='no'>exclude_years</span>,
  <span class='kw'>months</span> <span class='kw'>=</span> <span class='fl'>1</span>:<span class='fl'>12</span>,
  <span class='kw'>transpose</span> <span class='kw'>=</span> <span class='fl'>FALSE</span>
)</pre>

    <h2 class="hasAnchor" id="arguments"><a class="anchor" href="#arguments"></a>Arguments</h2>
    <table class="ref-arguments">
    <colgroup><col class="name" /><col class="desc" /></colgroup>
    <tr>
      <th>data</th>
      <td><p>A data frame of daily data that contains columns of dates, flow values, and (optional) groups (e.g. station numbers).
Leave blank if using <code>station_number</code> argument.</p></td>
    </tr>
    <tr>
      <th>dates</th>
      <td><p>Column in <code>data</code> that contains dates formatted YYYY-MM-DD. Only required if dates column name is not '
Date' (default). Leave blank if using <code>station_number</code> argument.</p></td>
    </tr>
    <tr>
      <th>values</th>
      <td><p>Column in <code>data</code> that contains numeric flow values, in units of cubic metres per second.
Only required if values column name is not 'Value' (default). Leave blank if using <code>station_number</code> argument.</p></td>
    </tr>
    <tr>
      <th>groups</th>
      <td><p>Column in <code>data</code> that contains unique identifiers for different data sets, if applicable. Only required if
groups column name is not 'STATION_NUMBER'. Function will automatically group by a column named 'STATION_NUMBER' if present.
Remove the 'STATION_NUMBER' column beforehand to remove this grouping. Leave blank if using <code>station_number</code> argument.</p></td>
    </tr>
    <tr>
      <th>station_number</th>
      <td><p>A character string vector of seven digit Water Survey of Canada station numbers (e.g. <code>"08NM116"</code>) of
which to extract daily streamflow data from a HYDAT database. Requires <code>tidyhydat</code> package and a HYDAT database.
Leave blank if using <code>data</code> argument.</p></td>
    </tr>
    <tr>
      <th>normal_percentiles</th>
      <td><p>Numeric vector of two values, lower and upper percentiles, respectively indicating the limits of the 
normal range. Default <code><a href='https://rdrr.io/r/base/c.html'>c(25,75)</a></code>.</p></td>
    </tr>
    <tr>
      <th>roll_days</th>
      <td><p>Numeric value of the number of days to apply a rolling mean. Default <code>1</code>.</p></td>
    </tr>
    <tr>
      <th>roll_align</th>
      <td><p>Character string identifying the direction of the rolling mean from the specified date, either by the first 
('left'), last ('right), or middle ('center') day of the rolling n-day group of observations. Default <code>'right'</code>.</p></td>
    </tr>
    <tr>
      <th>water_year_start</th>
      <td><p>Numeric value indicating the month of the start of the water year for analysis. Default <code>1</code>.</p></td>
    </tr>
    <tr>
      <th>start_year</th>
      <td><p>Numeric value of the first year to consider for analysis. Leave blank to use the first year of the source data.</p></td>
    </tr>
    <tr>
      <th>end_year</th>
      <td><p>Numeric value of the last year to consider for analysis. Leave blank to use the last year of the source data.</p></td>
    </tr>
    <tr>
      <th>exclude_years</th>
      <td><p>Numeric vector of years to exclude from analysis. Leave blank to include all years.</p></td>
    </tr>
    <tr>
      <th>months</th>
      <td><p>Numeric vector of months to include in analysis (e.g.. <code>6:8</code> for Jun-Aug). Leave blank to summarize 
all months (default <code>1:12</code>).</p></td>
    </tr>
    <tr>
      <th>transpose</th>
      <td><p>Logical value indicating if the results rows and columns are to be switched. Default <code>FALSE</code>.</p></td>
    </tr>
    </table>

    <h2 class="hasAnchor" id="value"><a class="anchor" href="#value"></a>Value</h2>

    <p>A tibble data frame with the following columns:</p>
<dt>Year</dt><dd><p>calendar or water year selected</p></dd>
  <dt>Days_Below_Normal</dt><dd><p>number of days per year below the daily normal (default 25th percentile)</p></dd>
  <dt>Days_Above_Normal</dt><dd><p>number of days per year above the daily normal (default 75th percentile)</p></dd>
  <dt>Days_Outside_Normal</dt><dd><p>number of days per year below and above the daily normal (default 25/75th percentile)</p></dd>
  Transposing data creates a column of "Statistics" and subsequent columns for each year selected.


    <h2 class="hasAnchor" id="examples"><a class="anchor" href="#examples"></a>Examples</h2>
    <pre class="examples"><div class='input'><span class='co'># Run if HYDAT database has been downloaded (using tidyhydat::download_hydat())</span>
<span class='kw'>if</span> (<span class='fu'><a href='https://rdrr.io/r/base/files.html'>file.exists</a></span>(<span class='kw pkg'>tidyhydat</span><span class='kw ns'>::</span><span class='fu'><a href='https://docs.ropensci.org/tidyhydat/reference/hy_test_db.html'>hy_downloaded_db</a></span>())) {

<span class='co'># Calculate statistics with default limits of normal (25 and 75th percentiles)</span>
<span class='fu'>calc_annual_outside_normal</span>(<span class='kw'>station_number</span> <span class='kw'>=</span> <span class='st'>"08NM116"</span>)

<span class='co'># Calculate statistics with custom limits of normal</span>
<span class='fu'>calc_annual_outside_normal</span>(<span class='kw'>station_number</span> <span class='kw'>=</span> <span class='st'>"08NM116"</span>,
                           <span class='kw'>normal_percentiles</span> <span class='kw'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span>(<span class='fl'>10</span>,<span class='fl'>90</span>))

}</div><div class='output co'>#&gt; <span class='warning'>Warning: One or more calculations included missing values and NA's were produced. Filter data for complete years or months, or use to ignore_missing = TRUE to ignore missing values.</span></div><div class='output co'>#&gt; <span class='warning'>Warning: One or more calculations included missing values and NA's were produced. Filter data for complete years or months, or use to ignore_missing = TRUE to ignore missing values.</span></div><div class='output co'>#&gt; <span style='color: #555555;'># A tibble: 69 x 5</span><span>
#&gt;    STATION_NUMBER  Year Days_Below_Normal Days_Above_Normal Days_Outside_Normal
#&gt;    </span><span style='color: #555555;font-style: italic;'>&lt;chr&gt;</span><span>          </span><span style='color: #555555;font-style: italic;'>&lt;dbl&gt;</span><span>             </span><span style='color: #555555;font-style: italic;'>&lt;int&gt;</span><span>             </span><span style='color: #555555;font-style: italic;'>&lt;int&gt;</span><span>               </span><span style='color: #555555;font-style: italic;'>&lt;int&gt;</span><span>
#&gt; </span><span style='color: #555555;'> 1</span><span> 08NM116         </span><span style='text-decoration: underline;'>1</span><span>949                </span><span style='color: #BB0000;'>NA</span><span>                </span><span style='color: #BB0000;'>NA</span><span>                  </span><span style='color: #BB0000;'>NA</span><span>
#&gt; </span><span style='color: #555555;'> 2</span><span> 08NM116         </span><span style='text-decoration: underline;'>1</span><span>950                </span><span style='color: #BB0000;'>NA</span><span>                </span><span style='color: #BB0000;'>NA</span><span>                  </span><span style='color: #BB0000;'>NA</span><span>
#&gt; </span><span style='color: #555555;'> 3</span><span> 08NM116         </span><span style='text-decoration: underline;'>1</span><span>951                </span><span style='color: #BB0000;'>NA</span><span>                </span><span style='color: #BB0000;'>NA</span><span>                  </span><span style='color: #BB0000;'>NA</span><span>
#&gt; </span><span style='color: #555555;'> 4</span><span> 08NM116         </span><span style='text-decoration: underline;'>1</span><span>952                </span><span style='color: #BB0000;'>NA</span><span>                </span><span style='color: #BB0000;'>NA</span><span>                  </span><span style='color: #BB0000;'>NA</span><span>
#&gt; </span><span style='color: #555555;'> 5</span><span> 08NM116         </span><span style='text-decoration: underline;'>1</span><span>953                </span><span style='color: #BB0000;'>NA</span><span>                </span><span style='color: #BB0000;'>NA</span><span>                  </span><span style='color: #BB0000;'>NA</span><span>
#&gt; </span><span style='color: #555555;'> 6</span><span> 08NM116         </span><span style='text-decoration: underline;'>1</span><span>954                </span><span style='color: #BB0000;'>NA</span><span>                </span><span style='color: #BB0000;'>NA</span><span>                  </span><span style='color: #BB0000;'>NA</span><span>
#&gt; </span><span style='color: #555555;'> 7</span><span> 08NM116         </span><span style='text-decoration: underline;'>1</span><span>955                </span><span style='color: #BB0000;'>NA</span><span>                </span><span style='color: #BB0000;'>NA</span><span>                  </span><span style='color: #BB0000;'>NA</span><span>
#&gt; </span><span style='color: #555555;'> 8</span><span> 08NM116         </span><span style='text-decoration: underline;'>1</span><span>956                </span><span style='color: #BB0000;'>NA</span><span>                </span><span style='color: #BB0000;'>NA</span><span>                  </span><span style='color: #BB0000;'>NA</span><span>
#&gt; </span><span style='color: #555555;'> 9</span><span> 08NM116         </span><span style='text-decoration: underline;'>1</span><span>957                </span><span style='color: #BB0000;'>NA</span><span>                </span><span style='color: #BB0000;'>NA</span><span>                  </span><span style='color: #BB0000;'>NA</span><span>
#&gt; </span><span style='color: #555555;'>10</span><span> 08NM116         </span><span style='text-decoration: underline;'>1</span><span>958                </span><span style='color: #BB0000;'>NA</span><span>                </span><span style='color: #BB0000;'>NA</span><span>                  </span><span style='color: #BB0000;'>NA</span><span>
#&gt; </span><span style='color: #555555;'># ... with 59 more rows</span><span></div></span></pre>
  </div>
  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">
    <nav id="toc" data-toggle="toc" class="sticky-top">
      <h2 data-toc-skip>Contents</h2>
    </nav>
  </div>
</div>


      <footer>
      <div class="copyright">
  <p>Developed by Jon Goetz, Carl James Schwarz.</p>
</div>

<div class="pkgdown">
  <p>Site built with <a href="https://pkgdown.r-lib.org/">pkgdown</a> 1.5.1.</p>
</div>

      </footer>
   </div>

  


  </body>
</html>


